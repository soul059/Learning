# Event Handling in Swing

## 1. Introduction to Event Handling

Event handling in Swing follows the delegation event model where events are generated by event sources (components) and handled by event listeners.

### Key Concepts
- **Event Source**: Component that generates events (buttons, text fields, etc.)
- **Event Object**: Contains information about the event
- **Event Listener**: Interface that defines methods to handle events
- **Event Registration**: Process of connecting listeners to sources

### Event Handling Flow
1. User performs an action (click, type, etc.)
2. Event source generates an event object
3. Event is sent to all registered listeners
4. Listener methods are invoked to handle the event

## 2. ActionEvent and ActionListener

The most commonly used event in Swing applications.

### Basic ActionListener Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class BasicActionEventDemo extends JFrame {
    private JLabel messageLabel;
    private int clickCount = 0;
    
    public BasicActionEventDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        messageLabel = new JLabel("Click a button!", JLabel.CENTER);
        messageLabel.setFont(new Font("Arial", Font.PLAIN, 14));
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        JPanel buttonPanel = new JPanel(new FlowLayout());
        
        // Button with anonymous inner class
        JButton button1 = new JButton("Button 1 (Anonymous)");
        button1.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                messageLabel.setText("Button 1 clicked! (Anonymous Inner Class)");
            }
        });
        
        // Button with lambda expression (Java 8+)
        JButton button2 = new JButton("Button 2 (Lambda)");
        button2.addActionListener(e -> {
            messageLabel.setText("Button 2 clicked! (Lambda Expression)");
        });
        
        // Button with method reference
        JButton button3 = new JButton("Button 3 (Method Ref)");
        button3.addActionListener(this::handleButton3Click);
        
        // Button with separate listener class
        JButton button4 = new JButton("Button 4 (Separate Class)");
        button4.addActionListener(new Button4Listener());
        
        // Counter button
        JButton counterButton = new JButton("Click Counter");
        counterButton.addActionListener(e -> {
            clickCount++;
            messageLabel.setText("Counter button clicked " + clickCount + " times");
        });
        
        buttonPanel.add(button1);
        buttonPanel.add(button2);
        buttonPanel.add(button3);
        buttonPanel.add(button4);
        buttonPanel.add(counterButton);
        
        add(messageLabel, BorderLayout.CENTER);
        add(buttonPanel, BorderLayout.SOUTH);
    }
    
    private void setupEventHandlers() {
        // Additional setup if needed
    }
    
    // Method for method reference
    private void handleButton3Click(ActionEvent e) {
        messageLabel.setText("Button 3 clicked! (Method Reference)");
    }
    
    // Separate listener class as inner class
    private class Button4Listener implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent e) {
            messageLabel.setText("Button 4 clicked! (Separate Listener Class)");
        }
    }
    
    private void configureFrame() {
        setTitle("ActionEvent Demo");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setSize(600, 200);
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new BasicActionEventDemo().setVisible(true);
        });
    }
}
```

### Advanced ActionEvent Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

public class AdvancedActionEventDemo extends JFrame {
    private JTextArea logArea;
    private JTextField inputField;
    private JButton clearButton, saveButton, exitButton;
    
    public AdvancedActionEventDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        logArea = new JTextArea(15, 40);
        logArea.setEditable(false);
        logArea.setFont(new Font("Courier New", Font.PLAIN, 12));
        
        inputField = new JTextField(20);
        clearButton = new JButton("Clear Log");
        saveButton = new JButton("Save Entry");
        exitButton = new JButton("Exit");
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        // Top panel with input
        JPanel topPanel = new JPanel(new FlowLayout());
        topPanel.add(new JLabel("Enter message:"));
        topPanel.add(inputField);
        topPanel.add(saveButton);
        
        // Center panel with log
        JScrollPane scrollPane = new JScrollPane(logArea);
        scrollPane.setBorder(BorderFactory.createTitledBorder("Activity Log"));
        
        // Bottom panel with controls
        JPanel bottomPanel = new JPanel(new FlowLayout());
        bottomPanel.add(clearButton);
        bottomPanel.add(exitButton);
        
        add(topPanel, BorderLayout.NORTH);
        add(scrollPane, BorderLayout.CENTER);
        add(bottomPanel, BorderLayout.SOUTH);
    }
    
    private void setupEventHandlers() {
        // Save button - add entry to log
        saveButton.addActionListener(e -> {
            String message = inputField.getText().trim();
            if (!message.isEmpty()) {
                addLogEntry("USER INPUT: " + message);
                inputField.setText("");
                inputField.requestFocus();
            } else {
                addLogEntry("WARNING: Empty message not saved");
            }
        });
        
        // Clear button - clear the log
        clearButton.addActionListener(e -> {
            int result = JOptionPane.showConfirmDialog(
                this,
                "Are you sure you want to clear the log?",
                "Confirm Clear",
                JOptionPane.YES_NO_OPTION
            );
            
            if (result == JOptionPane.YES_OPTION) {
                logArea.setText("");
                addLogEntry("Log cleared by user");
            }
        });
        
        // Exit button - close application
        exitButton.addActionListener(e -> {
            int result = JOptionPane.showConfirmDialog(
                this,
                "Are you sure you want to exit?",
                "Confirm Exit",
                JOptionPane.YES_NO_OPTION
            );
            
            if (result == JOptionPane.YES_OPTION) {
                addLogEntry("Application closing...");
                System.exit(0);
            }
        });
        
        // Enter key in text field triggers save
        inputField.addActionListener(e -> saveButton.doClick());
        
        // Log application start
        addLogEntry("Application started");
    }
    
    private void addLogEntry(String message) {
        String timestamp = LocalDateTime.now().format(
            DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")
        );
        String logEntry = "[" + timestamp + "] " + message + "\n";
        logArea.append(logEntry);
        logArea.setCaretPosition(logArea.getDocument().getLength());
    }
    
    private void configureFrame() {
        setTitle("Advanced ActionEvent Demo");
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        
        // Custom window closing handler
        addWindowListener(new java.awt.event.WindowAdapter() {
            @Override
            public void windowClosing(java.awt.event.WindowEvent e) {
                exitButton.doClick(); // Reuse exit button logic
            }
        });
        
        pack();
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new AdvancedActionEventDemo().setVisible(true);
        });
    }
}
```

## 3. Mouse Events

Handling mouse clicks, movements, and other mouse interactions.

### MouseListener and MouseMotionListener Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;
import java.util.List;

public class MouseEventDemo extends JFrame {
    private DrawingPanel drawingPanel;
    private JLabel statusLabel;
    private JLabel coordinateLabel;
    
    public MouseEventDemo() {
        setupComponents();
        setupLayout();
        configureFrame();
    }
    
    private void setupComponents() {
        drawingPanel = new DrawingPanel();
        statusLabel = new JLabel("Click and drag to draw");
        coordinateLabel = new JLabel("Mouse position: (0, 0)");
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        JPanel statusPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        statusPanel.add(statusLabel);
        statusPanel.add(Box.createHorizontalStrut(20));
        statusPanel.add(coordinateLabel);
        
        add(drawingPanel, BorderLayout.CENTER);
        add(statusPanel, BorderLayout.SOUTH);
    }
    
    private class DrawingPanel extends JPanel {
        private List<Point> points = new ArrayList<>();
        private Point currentPoint = null;
        private boolean isDrawing = false;
        
        public DrawingPanel() {
            setBackground(Color.WHITE);
            setPreferredSize(new Dimension(600, 400));
            addMouseListener(new MouseHandler());
            addMouseMotionListener(new MouseMotionHandler());
        }
        
        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            
            Graphics2D g2d = (Graphics2D) g;
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
                               RenderingHints.VALUE_ANTIALIAS_ON);
            
            // Draw all points
            g2d.setColor(Color.BLUE);
            for (Point point : points) {
                g2d.fillOval(point.x - 2, point.y - 2, 4, 4);
            }
            
            // Draw current point if dragging
            if (currentPoint != null && isDrawing) {
                g2d.setColor(Color.RED);
                g2d.fillOval(currentPoint.x - 3, currentPoint.y - 3, 6, 6);
            }
        }
        
        private class MouseHandler implements MouseListener {
            @Override
            public void mouseClicked(MouseEvent e) {
                if (e.getClickCount() == 2) {
                    points.clear();
                    repaint();
                    statusLabel.setText("Canvas cleared (double-click)");
                } else {
                    points.add(e.getPoint());
                    repaint();
                    statusLabel.setText("Point added at (" + e.getX() + ", " + e.getY() + ")");
                }
            }
            
            @Override
            public void mousePressed(MouseEvent e) {
                isDrawing = true;
                currentPoint = e.getPoint();
                statusLabel.setText("Mouse pressed - start drawing");
                
                // Check for different mouse buttons
                if (SwingUtilities.isLeftMouseButton(e)) {
                    statusLabel.setText("Left button pressed");
                } else if (SwingUtilities.isRightMouseButton(e)) {
                    statusLabel.setText("Right button pressed");
                } else if (SwingUtilities.isMiddleMouseButton(e)) {
                    statusLabel.setText("Middle button pressed");
                }
            }
            
            @Override
            public void mouseReleased(MouseEvent e) {
                isDrawing = false;
                if (currentPoint != null) {
                    points.add(currentPoint);
                    currentPoint = null;
                    repaint();
                }
                statusLabel.setText("Mouse released - drawing stopped");
            }
            
            @Override
            public void mouseEntered(MouseEvent e) {
                statusLabel.setText("Mouse entered drawing area");
                setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));
            }
            
            @Override
            public void mouseExited(MouseEvent e) {
                statusLabel.setText("Mouse exited drawing area");
                setCursor(Cursor.getDefaultCursor());
            }
        }
        
        private class MouseMotionHandler implements MouseMotionListener {
            @Override
            public void mouseDragged(MouseEvent e) {
                if (isDrawing) {
                    currentPoint = e.getPoint();
                    points.add(new Point(e.getPoint()));
                    repaint();
                }
                coordinateLabel.setText("Mouse position: (" + e.getX() + ", " + e.getY() + ")");
            }
            
            @Override
            public void mouseMoved(MouseEvent e) {
                coordinateLabel.setText("Mouse position: (" + e.getX() + ", " + e.getY() + ")");
            }
        }
    }
    
    private void configureFrame() {
        setTitle("Mouse Event Demo - Click, drag, and double-click");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new MouseEventDemo().setVisible(true);
        });
    }
}
```

## 4. Key Events

Handling keyboard input and key combinations.

### KeyListener Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.HashSet;
import java.util.Set;

public class KeyEventDemo extends JFrame {
    private JTextArea displayArea;
    private JTextField inputField;
    private Set<Integer> pressedKeys = new HashSet<>();
    
    public KeyEventDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        displayArea = new JTextArea(15, 50);
        displayArea.setEditable(false);
        displayArea.setFont(new Font("Courier New", Font.PLAIN, 12));
        displayArea.setBackground(Color.BLACK);
        displayArea.setForeground(Color.GREEN);
        
        inputField = new JTextField(30);
        inputField.setFont(new Font("Arial", Font.PLAIN, 14));
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        JPanel topPanel = new JPanel(new FlowLayout());
        topPanel.add(new JLabel("Type in the field below (focus required):"));
        topPanel.add(inputField);
        
        JScrollPane scrollPane = new JScrollPane(displayArea);
        scrollPane.setBorder(BorderFactory.createTitledBorder("Key Event Log"));
        
        add(topPanel, BorderLayout.NORTH);
        add(scrollPane, BorderLayout.CENTER);
        
        // Instructions
        JTextArea instructions = new JTextArea(3, 50);
        instructions.setEditable(false);
        instructions.setText(
            "Instructions:\n" +
            "• Type in the text field to see key events\n" +
            "• Try special keys like Ctrl, Alt, Shift, Arrow keys, F1-F12\n" +
            "• Use Ctrl+C to clear the log"
        );
        instructions.setBackground(getBackground());
        add(instructions, BorderLayout.SOUTH);
    }
    
    private void setupEventHandlers() {
        inputField.addKeyListener(new KeyEventHandler());
        inputField.requestFocus();
        
        addLogEntry("Application started. Focus on text field and start typing...");
    }
    
    private class KeyEventHandler implements KeyListener {
        @Override
        public void keyTyped(KeyEvent e) {
            char keyChar = e.getKeyChar();
            String message = String.format("KEY TYPED: '%c' (Unicode: %d)", 
                                          keyChar, (int) keyChar);
            addLogEntry(message);
        }
        
        @Override
        public void keyPressed(KeyEvent e) {
            pressedKeys.add(e.getKeyCode());
            
            String keyName = KeyEvent.getKeyText(e.getKeyCode());
            String modifiers = getModifiersText(e);
            
            String message = String.format("KEY PRESSED: %s (Code: %d)%s", 
                                          keyName, e.getKeyCode(), modifiers);
            addLogEntry(message);
            
            // Handle special key combinations
            handleSpecialKeys(e);
        }
        
        @Override
        public void keyReleased(KeyEvent e) {
            pressedKeys.remove(e.getKeyCode());
            
            String keyName = KeyEvent.getKeyText(e.getKeyCode());
            String message = String.format("KEY RELEASED: %s (Code: %d)", 
                                          keyName, e.getKeyCode());
            addLogEntry(message);
        }
        
        private String getModifiersText(KeyEvent e) {
            StringBuilder modifiers = new StringBuilder();
            
            if (e.isControlDown()) modifiers.append(" +Ctrl");
            if (e.isAltDown()) modifiers.append(" +Alt");
            if (e.isShiftDown()) modifiers.append(" +Shift");
            if (e.isMetaDown()) modifiers.append(" +Meta");
            
            return modifiers.toString();
        }
        
        private void handleSpecialKeys(KeyEvent e) {
            // Clear log with Ctrl+C
            if (e.isControlDown() && e.getKeyCode() == KeyEvent.VK_C) {
                displayArea.setText("");
                addLogEntry("Log cleared with Ctrl+C");
                return;
            }
            
            // Show currently pressed keys with Ctrl+I
            if (e.isControlDown() && e.getKeyCode() == KeyEvent.VK_I) {
                StringBuilder pressedKeysText = new StringBuilder("Currently pressed keys: ");
                for (Integer keyCode : pressedKeys) {
                    pressedKeysText.append(KeyEvent.getKeyText(keyCode)).append(" ");
                }
                addLogEntry(pressedKeysText.toString());
                return;
            }
            
            // Special function key handling
            if (e.getKeyCode() >= KeyEvent.VK_F1 && e.getKeyCode() <= KeyEvent.VK_F12) {
                int functionNumber = e.getKeyCode() - KeyEvent.VK_F1 + 1;
                addLogEntry("Function key F" + functionNumber + " pressed!");
                return;
            }
            
            // Arrow key handling
            switch (e.getKeyCode()) {
                case KeyEvent.VK_UP:
                    addLogEntry("↑ UP arrow pressed");
                    break;
                case KeyEvent.VK_DOWN:
                    addLogEntry("↓ DOWN arrow pressed");
                    break;
                case KeyEvent.VK_LEFT:
                    addLogEntry("← LEFT arrow pressed");
                    break;
                case KeyEvent.VK_RIGHT:
                    addLogEntry("→ RIGHT arrow pressed");
                    break;
            }
        }
    }
    
    private void addLogEntry(String message) {
        displayArea.append(message + "\n");
        displayArea.setCaretPosition(displayArea.getDocument().getLength());
    }
    
    private void configureFrame() {
        setTitle("Key Event Demo");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new KeyEventDemo().setVisible(true);
        });
    }
}
```

## 5. Window Events

Handling window-related events like opening, closing, minimizing.

### WindowListener Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.WindowEvent;
import java.awt.event.WindowListener;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

public class WindowEventDemo extends JFrame {
    private JTextArea logArea;
    private boolean isModified = false;
    
    public WindowEventDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        logArea = new JTextArea(20, 50);
        logArea.setFont(new Font("Courier New", Font.PLAIN, 12));
        
        // Add document listener to track modifications
        logArea.getDocument().addDocumentListener(new javax.swing.event.DocumentListener() {
            public void insertUpdate(javax.swing.event.DocumentEvent e) { isModified = true; updateTitle(); }
            public void removeUpdate(javax.swing.event.DocumentEvent e) { isModified = true; updateTitle(); }
            public void changedUpdate(javax.swing.event.DocumentEvent e) { isModified = true; updateTitle(); }
        });
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        JScrollPane scrollPane = new JScrollPane(logArea);
        scrollPane.setBorder(BorderFactory.createTitledBorder("Event Log"));
        
        JPanel buttonPanel = new JPanel(new FlowLayout());
        
        JButton newWindowButton = new JButton("Open New Window");
        newWindowButton.addActionListener(e -> openNewWindow());
        
        JButton minimizeButton = new JButton("Minimize");
        minimizeButton.addActionListener(e -> setState(Frame.ICONIFIED));
        
        JButton clearButton = new JButton("Clear Log");
        clearButton.addActionListener(e -> {
            logArea.setText("");
            isModified = false;
            updateTitle();
        });
        
        buttonPanel.add(newWindowButton);
        buttonPanel.add(minimizeButton);
        buttonPanel.add(clearButton);
        
        add(scrollPane, BorderLayout.CENTER);
        add(buttonPanel, BorderLayout.SOUTH);
        
        // Instructions
        JLabel instructions = new JLabel(
            "<html>Try: minimizing, maximizing, moving, resizing, or closing this window.<br>" +
            "Type in the text area to make the document 'modified'.</html>"
        );
        instructions.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
        add(instructions, BorderLayout.NORTH);
    }
    
    private void setupEventHandlers() {
        addWindowListener(new WindowEventHandler());
        logEvent("Window created and initialized");
    }
    
    private class WindowEventHandler implements WindowListener {
        @Override
        public void windowOpened(WindowEvent e) {
            logEvent("Window opened - window is displayed for the first time");
        }
        
        @Override
        public void windowClosing(WindowEvent e) {
            logEvent("Window closing - user requested to close window");
            
            if (isModified) {
                int result = JOptionPane.showConfirmDialog(
                    WindowEventDemo.this,
                    "You have unsaved changes. Do you want to exit without saving?",
                    "Unsaved Changes",
                    JOptionPane.YES_NO_CANCEL_OPTION,
                    JOptionPane.WARNING_MESSAGE
                );
                
                switch (result) {
                    case JOptionPane.YES_OPTION:
                        logEvent("User chose to exit without saving");
                        dispose(); // This will trigger windowClosed
                        break;
                    case JOptionPane.NO_OPTION:
                        logEvent("User chose not to exit - simulating save");
                        // Here you would typically save the file
                        isModified = false;
                        updateTitle();
                        dispose();
                        break;
                    case JOptionPane.CANCEL_OPTION:
                    case JOptionPane.CLOSED_OPTION:
                        logEvent("User cancelled exit operation");
                        break;
                }
            } else {
                dispose();
            }
        }
        
        @Override
        public void windowClosed(WindowEvent e) {
            logEvent("Window closed - window has been closed and disposed");
            // Note: This method is called after the window is actually closed
            // You cannot interact with the window components here
            System.out.println("Window closed event logged to console (GUI is gone)");
        }
        
        @Override
        public void windowIconified(WindowEvent e) {
            logEvent("Window iconified - window was minimized");
        }
        
        @Override
        public void windowDeiconified(WindowEvent e) {
            logEvent("Window deiconified - window was restored from minimized state");
        }
        
        @Override
        public void windowActivated(WindowEvent e) {
            logEvent("Window activated - window gained focus");
        }
        
        @Override
        public void windowDeactivated(WindowEvent e) {
            logEvent("Window deactivated - window lost focus");
        }
    }
    
    private void openNewWindow() {
        JFrame newWindow = new JFrame("Secondary Window");
        newWindow.setSize(300, 200);
        newWindow.setLocationRelativeTo(this);
        
        newWindow.add(new JLabel("This is a secondary window", JLabel.CENTER));
        
        newWindow.addWindowListener(new WindowListener() {
            @Override
            public void windowOpened(WindowEvent e) {
                logEvent("Secondary window opened");
            }
            
            @Override
            public void windowClosing(WindowEvent e) {
                logEvent("Secondary window closing");
                newWindow.dispose();
            }
            
            @Override
            public void windowClosed(WindowEvent e) {
                logEvent("Secondary window closed");
            }
            
            @Override
            public void windowIconified(WindowEvent e) {
                logEvent("Secondary window iconified");
            }
            
            @Override
            public void windowDeiconified(WindowEvent e) {
                logEvent("Secondary window deiconified");
            }
            
            @Override
            public void windowActivated(WindowEvent e) {
                logEvent("Secondary window activated");
            }
            
            @Override
            public void windowDeactivated(WindowEvent e) {
                logEvent("Secondary window deactivated");
            }
        });
        
        newWindow.setVisible(true);
    }
    
    private void logEvent(String event) {
        String timestamp = LocalDateTime.now().format(
            DateTimeFormatter.ofPattern("HH:mm:ss.SSS")
        );
        String logEntry = "[" + timestamp + "] " + event + "\n";
        
        if (logArea != null) {
            logArea.append(logEntry);
            logArea.setCaretPosition(logArea.getDocument().getLength());
        }
    }
    
    private void updateTitle() {
        String title = "Window Event Demo";
        if (isModified) {
            title += " *";
        }
        setTitle(title);
    }
    
    private void configureFrame() {
        setTitle("Window Event Demo");
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        setSize(700, 500);
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new WindowEventDemo().setVisible(true);
        });
    }
}
```

## 6. Focus Events

Handling when components gain or lose focus.

### FocusListener Example
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.FocusEvent;
import java.awt.event.FocusListener;

public class FocusEventDemo extends JFrame {
    private JTextArea logArea;
    private JTextField[] textFields;
    private int focusChangeCount = 0;
    
    public FocusEventDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        logArea = new JTextArea(10, 40);
        logArea.setEditable(false);
        logArea.setFont(new Font("Courier New", Font.PLAIN, 12));
        
        textFields = new JTextField[4];
        for (int i = 0; i < textFields.length; i++) {
            textFields[i] = new JTextField(15);
            textFields[i].setName("TextField" + (i + 1));
        }
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        // Create form panel
        JPanel formPanel = new JPanel(new GridBagLayout());
        formPanel.setBorder(BorderFactory.createTitledBorder("Form Fields"));
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.insets = new Insets(5, 5, 5, 5);
        gbc.anchor = GridBagConstraints.WEST;
        
        String[] labels = {"First Name:", "Last Name:", "Email:", "Phone:"};
        
        for (int i = 0; i < labels.length; i++) {
            gbc.gridx = 0;
            gbc.gridy = i;
            formPanel.add(new JLabel(labels[i]), gbc);
            
            gbc.gridx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            gbc.weightx = 1.0;
            formPanel.add(textFields[i], gbc);
            gbc.fill = GridBagConstraints.NONE;
            gbc.weightx = 0;
        }
        
        // Add buttons
        gbc.gridx = 0;
        gbc.gridy = labels.length;
        gbc.gridwidth = 2;
        gbc.fill = GridBagConstraints.NONE;
        gbc.anchor = GridBagConstraints.CENTER;
        
        JPanel buttonPanel = new JPanel(new FlowLayout());
        JButton submitButton = new JButton("Submit");
        JButton clearButton = new JButton("Clear");
        JButton focusFirstButton = new JButton("Focus First");
        
        buttonPanel.add(submitButton);
        buttonPanel.add(clearButton);
        buttonPanel.add(focusFirstButton);
        formPanel.add(buttonPanel, gbc);
        
        // Log panel
        JScrollPane scrollPane = new JScrollPane(logArea);
        scrollPane.setBorder(BorderFactory.createTitledBorder("Focus Event Log"));
        
        add(formPanel, BorderLayout.NORTH);
        add(scrollPane, BorderLayout.CENTER);
        
        // Button actions
        clearButton.addActionListener(e -> {
            for (JTextField field : textFields) {
                field.setText("");
            }
            logArea.setText("");
            focusChangeCount = 0;
            logEvent("All fields and log cleared");
        });
        
        focusFirstButton.addActionListener(e -> {
            textFields[0].requestFocus();
            logEvent("Focus manually set to first field");
        });
        
        submitButton.addActionListener(e -> {
            StringBuilder data = new StringBuilder("Form Data: ");
            for (int i = 0; i < textFields.length; i++) {
                data.append(labels[i].replace(":", "")).append("='")
                    .append(textFields[i].getText()).append("' ");
            }
            logEvent(data.toString());
        });
    }
    
    private void setupEventHandlers() {
        FocusEventHandler focusHandler = new FocusEventHandler();
        
        for (JTextField field : textFields) {
            field.addFocusListener(focusHandler);
        }
        
        logEvent("Focus event demo initialized. Click on different text fields.");
    }
    
    private class FocusEventHandler implements FocusListener {
        @Override
        public void focusGained(FocusEvent e) {
            focusChangeCount++;
            Component source = e.getComponent();
            String sourceName = source.getName();
            
            // Change background color to indicate focus
            source.setBackground(Color.YELLOW);
            
            // Log the event
            String message = String.format("FOCUS GAINED: %s (Change #%d)", 
                                          sourceName, focusChangeCount);
            logEvent(message);
            
            // Check if focus was gained temporarily
            if (e.isTemporary()) {
                logEvent("  → This is a TEMPORARY focus gain");
            }
            
            // Show current field value if any
            if (source instanceof JTextField) {
                JTextField field = (JTextField) source;
                if (!field.getText().isEmpty()) {
                    logEvent("  → Current value: '" + field.getText() + "'");
                }
            }
        }
        
        @Override
        public void focusLost(FocusEvent e) {
            Component source = e.getComponent();
            String sourceName = source.getName();
            
            // Restore background color
            source.setBackground(Color.WHITE);
            
            // Log the event
            String message = String.format("FOCUS LOST: %s", sourceName);
            logEvent(message);
            
            // Check if focus was lost temporarily
            if (e.isTemporary()) {
                logEvent("  → This is a TEMPORARY focus loss");
            }
            
            // Validate field content when focus is lost
            if (source instanceof JTextField) {
                JTextField field = (JTextField) source;
                validateField(field);
            }
        }
        
        private void validateField(JTextField field) {
            String fieldName = field.getName();
            String value = field.getText().trim();
            
            if (value.isEmpty()) {
                logEvent("  → Warning: " + fieldName + " is empty");
                return;
            }
            
            // Simple validation based on field name
            switch (fieldName) {
                case "TextField3": // Email field
                    if (!value.contains("@")) {
                        logEvent("  → Warning: Email should contain '@'");
                        field.setBorder(BorderFactory.createLineBorder(Color.RED, 2));
                    } else {
                        logEvent("  → Email format looks good");
                        field.setBorder(UIManager.getBorder("TextField.border"));
                    }
                    break;
                    
                case "TextField4": // Phone field
                    if (!value.matches("\\d+[\\d\\-\\s\\(\\)]*")) {
                        logEvent("  → Warning: Phone should start with numbers");
                        field.setBorder(BorderFactory.createLineBorder(Color.RED, 2));
                    } else {
                        logEvent("  → Phone format looks good");
                        field.setBorder(UIManager.getBorder("TextField.border"));
                    }
                    break;
                    
                default:
                    logEvent("  → Value: '" + value + "'");
                    field.setBorder(UIManager.getBorder("TextField.border"));
            }
        }
    }
    
    private void logEvent(String event) {
        logArea.append(event + "\n");
        logArea.setCaretPosition(logArea.getDocument().getLength());
    }
    
    private void configureFrame() {
        setTitle("Focus Event Demo");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new FocusEventDemo().setVisible(true);
        });
    }
}
```

## 7. Event Adapter Classes

Using adapter classes to implement only needed methods.

### Using Event Adapters
```java
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class EventAdapterDemo extends JFrame {
    private JLabel statusLabel;
    private JPanel drawingPanel;
    private Point lastPoint;
    
    public EventAdapterDemo() {
        setupComponents();
        setupLayout();
        setupEventHandlers();
        configureFrame();
    }
    
    private void setupComponents() {
        statusLabel = new JLabel("Ready - Try mouse and keyboard interactions");
        statusLabel.setBorder(BorderFactory.createEmptyBorder(5, 10, 5, 10));
        
        drawingPanel = new JPanel() {
            @Override
            protected void paintComponent(Graphics g) {
                super.paintComponent(g);
                if (lastPoint != null) {
                    g.setColor(Color.RED);
                    g.fillOval(lastPoint.x - 5, lastPoint.y - 5, 10, 10);
                }
            }
        };
        drawingPanel.setBackground(Color.WHITE);
        drawingPanel.setPreferredSize(new Dimension(400, 300));
        drawingPanel.setFocusable(true); // Important for key events
    }
    
    private void setupLayout() {
        setLayout(new BorderLayout());
        
        drawingPanel.setBorder(BorderFactory.createTitledBorder(
            "Click, drag, and use keyboard (panel must have focus)"));
        
        add(drawingPanel, BorderLayout.CENTER);
        add(statusLabel, BorderLayout.SOUTH);
    }
    
    private void setupEventHandlers() {
        // Using MouseAdapter instead of implementing all MouseListener methods
        drawingPanel.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                lastPoint = e.getPoint();
                drawingPanel.repaint();
                statusLabel.setText("Mouse clicked at (" + e.getX() + ", " + e.getY() + ")");
                
                // Request focus for keyboard events
                drawingPanel.requestFocus();
            }
            
            @Override
            public void mouseEntered(MouseEvent e) {
                statusLabel.setText("Mouse entered drawing area");
                drawingPanel.setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));
            }
            
            @Override
            public void mouseExited(MouseEvent e) {
                statusLabel.setText("Mouse exited drawing area");
                drawingPanel.setCursor(Cursor.getDefaultCursor());
            }
            
            // Note: We don't need to implement mousePressed and mouseReleased
            // because we're using an adapter class
        });
        
        // Using MouseMotionAdapter
        drawingPanel.addMouseMotionListener(new MouseMotionAdapter() {
            @Override
            public void mouseMoved(MouseEvent e) {
                statusLabel.setText("Mouse at (" + e.getX() + ", " + e.getY() + ")");
            }
            
            // We only need mouseMoved, so we don't implement mouseDragged
        });
        
        // Using KeyAdapter
        drawingPanel.addKeyListener(new KeyAdapter() {
            @Override
            public void keyPressed(KeyEvent e) {
                switch (e.getKeyCode()) {
                    case KeyEvent.VK_SPACE:
                        lastPoint = null;
                        drawingPanel.repaint();
                        statusLabel.setText("Drawing cleared with SPACE key");
                        break;
                        
                    case KeyEvent.VK_UP:
                        if (lastPoint != null) {
                            lastPoint.y = Math.max(0, lastPoint.y - 10);
                            drawingPanel.repaint();
                            statusLabel.setText("Point moved UP");
                        }
                        break;
                        
                    case KeyEvent.VK_DOWN:
                        if (lastPoint != null) {
                            lastPoint.y = Math.min(drawingPanel.getHeight() - 10, lastPoint.y + 10);
                            drawingPanel.repaint();
                            statusLabel.setText("Point moved DOWN");
                        }
                        break;
                        
                    case KeyEvent.VK_LEFT:
                        if (lastPoint != null) {
                            lastPoint.x = Math.max(0, lastPoint.x - 10);
                            drawingPanel.repaint();
                            statusLabel.setText("Point moved LEFT");
                        }
                        break;
                        
                    case KeyEvent.VK_RIGHT:
                        if (lastPoint != null) {
                            lastPoint.x = Math.min(drawingPanel.getWidth() - 10, lastPoint.x + 10);
                            drawingPanel.repaint();
                            statusLabel.setText("Point moved RIGHT");
                        }
                        break;
                        
                    default:
                        statusLabel.setText("Key pressed: " + KeyEvent.getKeyText(e.getKeyCode()));
                }
            }
            
            // We don't need keyTyped or keyReleased, so we don't implement them
        });
        
        // Using WindowAdapter for window events
        addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosing(WindowEvent e) {
                int result = JOptionPane.showConfirmDialog(
                    EventAdapterDemo.this,
                    "Are you sure you want to exit?",
                    "Confirm Exit",
                    JOptionPane.YES_NO_OPTION
                );
                
                if (result == JOptionPane.YES_OPTION) {
                    System.exit(0);
                }
                // If NO, the window won't close because we're using DO_NOTHING_ON_CLOSE
            }
            
            @Override
            public void windowActivated(WindowEvent e) {
                statusLabel.setText("Window activated - ready for input");
            }
            
            // We don't need other window events, so we don't implement them
        });
        
        // Using FocusAdapter
        drawingPanel.addFocusListener(new FocusAdapter() {
            @Override
            public void focusGained(FocusEvent e) {
                drawingPanel.setBorder(BorderFactory.createTitledBorder(
                    BorderFactory.createLineBorder(Color.BLUE, 2),
                    "Drawing Panel (HAS FOCUS - keyboard active)"
                ));
                statusLabel.setText("Drawing panel has focus - keyboard controls active");
            }
            
            @Override
            public void focusLost(FocusEvent e) {
                drawingPanel.setBorder(BorderFactory.createTitledBorder(
                    "Drawing Panel (click to focus for keyboard)"
                ));
            }
            
            // We don't need to handle temporary focus changes
        });
    }
    
    private void configureFrame() {
        setTitle("Event Adapter Demo");
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        pack();
        setLocationRelativeTo(null);
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new EventAdapterDemo().setVisible(true);
        });
    }
}
```

## Summary

Event handling is fundamental to creating interactive Swing applications:

### Key Event Types
- **ActionEvent**: Button clicks, menu selections, text field enter
- **MouseEvent**: Clicks, movements, drags, enter/exit
- **KeyEvent**: Key presses, releases, and typed characters
- **WindowEvent**: Opening, closing, minimizing, maximizing
- **FocusEvent**: Component gaining or losing focus

### Event Handling Approaches
1. **Anonymous Inner Classes**: Quick, one-time use
2. **Lambda Expressions**: Concise for simple handlers (Java 8+)
3. **Method References**: Clean when delegating to existing methods
4. **Separate Listener Classes**: Reusable, organized code
5. **Adapter Classes**: Implement only needed methods

### Best Practices
- Use appropriate event types for specific interactions
- Prefer lambda expressions for simple event handlers
- Use adapter classes when you don't need all listener methods
- Handle long-running operations in background threads
- Provide immediate feedback for user actions
- Validate input during appropriate events (focus lost, action performed)
- Use consistent event handling patterns throughout your application

### Performance Considerations
- Avoid heavy processing in event handlers
- Use SwingWorker for background tasks
- Remove listeners when components are no longer needed
- Be careful with event propagation and consumption
